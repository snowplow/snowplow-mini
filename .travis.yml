---
sudo: required
language: bash

services:
  - postgresql


before_install:
  - sudo apt-get update -qq

install:
  - sudo pip install ansible
  #acl is installed for creating postgresql user
  #see https://stackoverflow.com/a/36681626 for more information
  - sudo apt-get install -y acl
  - sudo pip install setuptools

before_script:
  - sudo adduser ubuntu --disabled-password --gecos ""
  - sudo passwd -d ubuntu
  - sudo mkdir /vagrant
  - sudo cp -r * /vagrant 
  - ansible-playbook -e provision=travis -i provisioning/inventory provisioning/travis-playbook.yml --connection=local --sudo

script:
  - ./integration/integration_test.sh
